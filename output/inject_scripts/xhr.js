(()=>{"use strict";var e=["load","loadend","timeout","error","readystatechange","abort"];function t(e,t){var n={};for(var r in e)n[r]=e[r];return n.target=n.currentTarget=t,n}var n,r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],c=e[5];function u(e){return e.watcher||(e.watcher=document.createElement("a"))}function l(e,n){var r,o=e.getProxy(),a="on"+n+"_",i=t({type:n},o);o[a]&&o[a](i),"function"==typeof Event?r=new Event(n,{bubbles:!1}):(r=document.createEvent("Event")).initEvent(n,!1,!0),u(e).dispatchEvent(r)}function f(e){this.xhr=e,this.xhrProxy=e.getProxy()}function h(e){function t(e){f.call(this,e)}return t.prototype=Object.create(f.prototype),t.prototype.next=e,t}f.prototype=Object.create({resolve:function(e){var t=this.xhrProxy,n=this.xhr;t.readyState=4,n.resHeader=e.headers,t.response=t.responseText=e.response,t.statusText=e.statusText,t.status=e.status,l(n,s),l(n,r),l(n,o)},reject:function(e){this.xhrProxy.status=0,l(this.xhr,e.type),l(this.xhr,o)}});var d=h((function(e){var t=this.xhr;for(var n in e=e||t.config,t.withCredentials=e.withCredentials,t.open(e.method,e.url,!1!==e.async,e.user,e.password),e.headers)t.setRequestHeader(n,e.headers[n]);t.send(e.body)})),p=h((function(e){this.resolve(e)})),v=h((function(e){this.reject(e)}));function m(n,r){var o=n.onRequest,f=n.onResponse,h=n.onError;function m(){return!0}function y(e){return function(t,n){return function(e,t,n,r){var o=new v(e);n={config:e.config,error:n,type:r},h?h(n,o):o.next(n)}(t,0,n,e),!0}}function x(e,t){return 4===e.readyState&&0!==e.status?function(e,t){var n=new p(e),r={response:t.response,status:t.status,statusText:t.statusText,config:e.config,headers:e.resHeader||e.getAllResponseHeaders().split("\r\n").reduce((function(e,t){if(""===t)return e;var n=t.split(":");return e[n.shift()]=function(e){return e.replace(/^\s+|\s+$/g,"")}(n.join(":")),e}),{})};if(!f)return n.resolve(r);f(r,n)}(e,t):4!==e.readyState&&l(e,s),!0}return function(n,r){function o(e){return function(){var t=this.hasOwnProperty(e+"_")?this[e+"_"]:this.xhr[e],r=(n[e]||{}).getter;return r&&r(t,this)||t}}function a(e){return function(r){var o=this.xhr,a=this,i=n[e];if("on"===e.substring(0,2))a[e+"_"]=r,o[e]=function(i){i=t(i,a),n[e]&&n[e].call(a,o,i)||r.call(a,i)};else{var s=(i||{}).setter;r=s&&s(r,a)||r,this[e+"_"]=r;try{o[e]=r}catch(e){}}}}function i(e){return function(){var t=[].slice.call(arguments);if(n[e]){var r=n[e].call(this,t,this.xhr);if(r)return r}return this.xhr[e].apply(this.xhr,t)}}return(r=r||window)._rxhr=r._rxhr||r.XMLHttpRequest,r.XMLHttpRequest=function(){for(var t=new r._rxhr,n=0;n<e.length;++n)void 0===t[e[n]]&&(t[e[n]]=null);for(var s in t){var c="";try{c=typeof t[s]}catch(e){}"function"===c?this[s]=i(s):Object.defineProperty(this,s,{get:o(s),set:a(s),enumerable:!0})}var u=this;t.getProxy=function(){return u},this.xhr=t},Object.assign(r.XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),r._rxhr}({onload:m,onloadend:m,onerror:y(i),ontimeout:y(a),onabort:y(c),onreadystatechange:function(e){return x(e,this)},open:function(e,t){var n=this,r=t.config={headers:{}};r.method=e[0],r.url=e[1],r.async=e[2],r.user=e[3],r.password=e[4],r.xhr=t;var a="on"+s;if(t[a]||(t[a]=function(){return x(t,n)}),o)return!0},send:function(e,t){var n=t.config;if(n.withCredentials=t.withCredentials,n.body=e[0],o){var r=function(){o(n,new d(t))};return!1===n.async?r():setTimeout(r),!0}},setRequestHeader:function(e,t){return t.config.headers[e[0].toLowerCase()]=e[1],!0},addEventListener:function(n,r){var o=this;if(-1!==e.indexOf(n[0])){var a=n[1];return u(r).addEventListener(n[0],(function(e){var r=t(e,o);r.type=n[0],r.isTrusted=!0,a.call(o,r)})),!0}},getAllResponseHeaders:function(e,t){var n=t.resHeader;if(n){var r="";for(var o in n)r+=o+": "+n[o]+"\r\n";return r}},getResponseHeader:function(e,t){var n=t.resHeader;if(n)return n[(e[0]||"").toLowerCase()]}},r)}var y=null;(y=document.createElement("div")).className="chrome-notification",document.body.appendChild(y);var x=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},w=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},g=[];function b(e,t){return x(this,void 0,void 0,(function(){return w(this,(function(n){switch(n.label){case 0:switch(console.log(e),e.mode){case 0:return[3,1];case 1:return[3,2]}return[3,4];case 1:return[2,e.resJson];case 2:return[4,E(e,t)];case 3:return[2,n.sent()];case 4:return[2]}}))}))}function E(e,t){return x(this,void 0,void 0,(function(){return w(this,(function(n){switch(n.label){case 0:return[4,new Function(e.resScript)(t)];case 1:return[2,n.sent()]}}))}))}!function(e){if(n)throw"Proxy already exists";n=new m(e)}({onRequest:function(e,t){return x(void 0,void 0,void 0,(function(){var n,r,o,a,i,s,c;return w(this,(function(u){switch(u.label){case 0:localStorage.getItem("chrome_mock_ext_show_notification"),u.label=1;case 1:u.trys.push([1,6,7,8]),n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(g),r=n.next(),u.label=2;case 2:return r.done?[3,5]:(o=r.value,new RegExp(o.regexpStr).test(e.url)?(function(e){var t=e.title,n=e.content,r=e.timeout,o=void 0===r?3e3:r,a=document.createElement("div");a.className="chrome-notification-panel";var i=document.createElement("div");i.className="chrome-notification-panel-title";var s=document.createElement("span");s.innerText=t;var c=document.createElement("i");function u(){c.removeEventListener("click",u);var e=a.clientWidth,t=0;requestAnimationFrame((function n(){t+=e/17,a.style.transform="translateX(".concat(t,"px)"),t<e+16?requestAnimationFrame(n):a.remove()}))}c.className="chrome-notification-panel-title-close",c.innerText="x",c.addEventListener("click",u);var l=document.createElement("div");l.className="chrome-notification-panel-content",l.innerHTML=n,i.appendChild(s),i.appendChild(c),a.appendChild(i),a.appendChild(l),y.appendChild(a);var f=a.clientWidth;a.style.transform="translateX(".concat(f+16,"px)");var h=f+16;requestAnimationFrame((function e(){h-=f/17,a.style.transform="translateX(".concat(h,"px)"),h>0&&requestAnimationFrame(e)})),setTimeout(u,o)}({title:"xhr_mock_ext拦截提醒",content:'/<span style="color:red">'.concat(o.regexpStr,"</span>/ ,已被拦截")}),[4,b(o,e)]):[3,4]);case 3:return a=u.sent(),console.log(a),[2,t.resolve({config:e,status:200,headers:{"content-type":"application/json;charset=UTF-8"},response:a})];case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return i=u.sent(),s={error:i},[3,8];case 7:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return t.next(e),[2]}}))}))}}),window.postMessage({event:"inject_get_matching",data:null}),window.addEventListener("message",(function(e){"inject_get_matching_res"===e.data.event&&(g=e.data.data)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQU0sT0FaVnZFLE9BQU95QixpQkFBaUIsV0FBVyxTQUFDN0gsR0FHYiw0QkFGRkEsRUFBQyxLQUVURixRQUNMd0ksRUFBWXRJLEVBQUUySyxLQUFLQSxVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veGhyLW1vY2stZXh0Ly4vbm9kZV9tb2R1bGVzL2FqYXgtaG9vay9zcmMveGhyLWhvb2suanMiLCJ3ZWJwYWNrOi8veGhyLW1vY2stZXh0Ly4vbm9kZV9tb2R1bGVzL2FqYXgtaG9vay9zcmMveGhyLXByb3h5LmpzIiwid2VicGFjazovL3hoci1tb2NrLWV4dC8uL3NyYy9jb21wb25lbnRzL25vdGlmaWNhdGlvbi50cyIsIndlYnBhY2s6Ly94aHItbW9jay1leHQvLi9zcmMvZW50cmllcy9pbmplY3Rfc2NyaXB0cy94aHIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIGF1dGhvcjogd2VuZHV4XG4gKiBlbWFpbDogODI0NzgzMTQ2QHFxLmNvbVxuICogc291cmNlIGNvZGU6IGh0dHBzOi8vZ2l0aHViLmNvbS93ZW5kdXgvQWpheC1ob29rXG4gKi9cblxuLy8gU2F2ZSBvcmlnaW5hbCBYTUxIdHRwUmVxdWVzdCBhcyBfcnhoclxudmFyIHJlYWxYaHIgPSBcIl9yeGhyXCJcblxuZXhwb3J0IHZhciBldmVudHMgPSBbJ2xvYWQnLCAnbG9hZGVuZCcsICd0aW1lb3V0JywgJ2Vycm9yJywgJ3JlYWR5c3RhdGVjaGFuZ2UnLCAnYWJvcnQnXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ0V2ZW50KGV2ZW50LCB4aHJQcm94eSkge1xuICB2YXIgZSA9IHt9O1xuICBmb3IgKHZhciBhdHRyIGluIGV2ZW50KSBlW2F0dHJdID0gZXZlbnRbYXR0cl07XG4gIC8vIHhoclByb3h5IGluc3RlYWRcbiAgZS50YXJnZXQgPSBlLmN1cnJlbnRUYXJnZXQgPSB4aHJQcm94eVxuICByZXR1cm4gZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhvb2socHJveHksIHdpbikge1xuICB3aW4gPSB3aW4gfHwgd2luZG93O1xuICAvLyBBdm9pZCBkb3VibGUgaG9va0FqYXhcbiAgd2luW3JlYWxYaHJdID0gd2luW3JlYWxYaHJdIHx8IHdpbi5YTUxIdHRwUmVxdWVzdFxuXG4gIHdpbi5YTUxIdHRwUmVxdWVzdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIFdlIHNob3VsZG4ndCBob29rQWpheCBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUgYmVjYXVzZSB3ZSBjYW4ndFxuICAgIC8vIGd1YXJhbnRlZSB0aGF0IGFsbCBhdHRyaWJ1dGVzIGFyZSBvbiB0aGUgcHJvdG90eXBl44CCXG4gICAgLy8gSW5zdGVhZCwgaG9va2luZyBYTUxIdHRwUmVxdWVzdCBpbnN0YW5jZSBjYW4gYXZvaWQgdGhpcyBwcm9ibGVtLlxuXG4gICAgdmFyIHhociA9IG5ldyB3aW5bcmVhbFhocl07XG5cblxuICAgIC8vIEdlbmVyYXRlIGFsbCBjYWxsYmFja3MoZWcuIG9ubG9hZCkgYXJlIGVudW1lcmFibGUgKG5vdCB1bmRlZmluZWQpLlxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICBpZiAoeGhyW2V2ZW50c1tpXV0gPT09IHVuZGVmaW5lZCkgeGhyW2V2ZW50c1tpXV0gPSBudWxsO1xuICAgIH1cblxuICAgIGZvciAodmFyIGF0dHIgaW4geGhyKSB7XG4gICAgICB2YXIgdHlwZSA9IFwiXCI7XG4gICAgICB0cnkge1xuICAgICAgICB0eXBlID0gdHlwZW9mIHhoclthdHRyXSAvLyBNYXkgY2F1c2UgZXhjZXB0aW9uIG9uIHNvbWUgYnJvd3NlclxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgfVxuICAgICAgaWYgKHR5cGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAvLyBob29rQWpheCBtZXRob2RzIG9mIHhociwgc3VjaCBhcyBgb3BlbmDjgIFgc2VuZGAgLi4uXG4gICAgICAgIHRoaXNbYXR0cl0gPSBob29rRnVuY3Rpb24oYXR0cik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgYXR0ciwge1xuICAgICAgICAgIGdldDogZ2V0dGVyRmFjdG9yeShhdHRyKSxcbiAgICAgICAgICBzZXQ6IHNldHRlckZhY3RvcnkoYXR0ciksXG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgeGhyLmdldFByb3h5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoYXRcbiAgICB9XG4gICAgdGhpcy54aHIgPSB4aHI7XG4gIH1cblxuICBPYmplY3QuYXNzaWduKHdpbi5YTUxIdHRwUmVxdWVzdCwge1VOU0VOVDogMCwgT1BFTkVEOiAxLCBIRUFERVJTX1JFQ0VJVkVEOiAyLCBMT0FESU5HOiAzLCBET05FOiA0fSk7XG5cbiAgLy8gR2VuZXJhdGUgZ2V0dGVyIGZvciBhdHRyaWJ1dGVzIG9mIHhoclxuICBmdW5jdGlvbiBnZXR0ZXJGYWN0b3J5KGF0dHIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHYgPSB0aGlzLmhhc093blByb3BlcnR5KGF0dHIgKyBcIl9cIikgPyB0aGlzW2F0dHIgKyBcIl9cIl0gOiB0aGlzLnhoclthdHRyXTtcbiAgICAgIHZhciBhdHRyR2V0dGVySG9vayA9IChwcm94eVthdHRyXSB8fCB7fSlbXCJnZXR0ZXJcIl1cbiAgICAgIHJldHVybiBhdHRyR2V0dGVySG9vayAmJiBhdHRyR2V0dGVySG9vayh2LCB0aGlzKSB8fCB2XG4gICAgfVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgc2V0dGVyIGZvciBhdHRyaWJ1dGVzIG9mIHhocjsgYnkgdGhpcyB3ZSBoYXZlIGFuIG9wcG9ydHVuaXR5XG4gIC8vIHRvIGhvb2tBamF4IGV2ZW50IGNhbGxiYWNrcyDvvIhlZzogYG9ubG9hZGDvvIkgb2YgeGhyO1xuICBmdW5jdGlvbiBzZXR0ZXJGYWN0b3J5KGF0dHIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHYpIHtcbiAgICAgIHZhciB4aHIgPSB0aGlzLnhocjtcbiAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgIHZhciBob29rID0gcHJveHlbYXR0cl07XG4gICAgICAvLyBob29rQWpheCAgZXZlbnQgY2FsbGJhY2tzIHN1Y2ggYXMgYG9ubG9hZGDjgIFgb25yZWFkeXN0YXRlY2hhbmdlYC4uLlxuICAgICAgaWYgKGF0dHIuc3Vic3RyaW5nKDAsIDIpID09PSAnb24nKSB7XG4gICAgICAgIHRoYXRbYXR0ciArIFwiX1wiXSA9IHY7XG4gICAgICAgIHhoclthdHRyXSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZSA9IGNvbmZpZ0V2ZW50KGUsIHRoYXQpXG4gICAgICAgICAgdmFyIHJldCA9IHByb3h5W2F0dHJdICYmIHByb3h5W2F0dHJdLmNhbGwodGhhdCwgeGhyLCBlKVxuICAgICAgICAgIHJldCB8fCB2LmNhbGwodGhhdCwgZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vSWYgdGhlIGF0dHJpYnV0ZSBpc24ndCB3cml0YWJsZSwgZ2VuZXJhdGUgcHJveHkgYXR0cmlidXRlXG4gICAgICAgIHZhciBhdHRyU2V0dGVySG9vayA9IChob29rIHx8IHt9KVtcInNldHRlclwiXTtcbiAgICAgICAgdiA9IGF0dHJTZXR0ZXJIb29rICYmIGF0dHJTZXR0ZXJIb29rKHYsIHRoYXQpIHx8IHZcbiAgICAgICAgdGhpc1thdHRyICsgXCJfXCJdID0gdjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBOb3QgYWxsIGF0dHJpYnV0ZXMgb2YgeGhyIGFyZSB3cml0YWJsZShzZXR0ZXIgbWF5IHVuZGVmaW5lZCkuXG4gICAgICAgICAgeGhyW2F0dHJdID0gdjtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gSG9vayBtZXRob2RzIG9mIHhoci5cbiAgZnVuY3Rpb24gaG9va0Z1bmN0aW9uKGZ1bikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKVxuICAgICAgaWYgKHByb3h5W2Z1bl0pIHtcbiAgICAgICAgdmFyIHJldCA9IHByb3h5W2Z1bl0uY2FsbCh0aGlzLCBhcmdzLCB0aGlzLnhocilcbiAgICAgICAgLy8gSWYgdGhlIHByb3h5IHJldHVybiB2YWx1ZSBleGlzdHMsIHJldHVybiBpdCBkaXJlY3RseSxcbiAgICAgICAgLy8gb3RoZXJ3aXNlIGNhbGwgdGhlIGZ1bmN0aW9uIG9mIHhoci5cbiAgICAgICAgaWYgKHJldCkgcmV0dXJuIHJldDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnhocltmdW5dLmFwcGx5KHRoaXMueGhyLCBhcmdzKTtcbiAgICB9XG4gIH1cblxuICAvLyBSZXR1cm4gdGhlIHJlYWwgWE1MSHR0cFJlcXVlc3RcbiAgcmV0dXJuIHdpbltyZWFsWGhyXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuSG9vayh3aW4pIHtcbiAgd2luID0gd2luIHx8IHdpbmRvd1xuICBpZiAod2luW3JlYWxYaHJdKSB3aW4uWE1MSHR0cFJlcXVlc3QgPSB3aW5bcmVhbFhocl07XG4gIHdpbltyZWFsWGhyXSA9IHVuZGVmaW5lZDtcbn1cblxuXG4iLCIvKlxuICogYXV0aG9yOiB3ZW5kdXhcbiAqIGVtYWlsOiA4MjQ3ODMxNDZAcXEuY29tXG4gKiBzb3VyY2UgY29kZTogaHR0cHM6Ly9naXRodWIuY29tL3dlbmR1eC9BamF4LWhvb2tcbiAqL1xuXG5pbXBvcnQge2hvb2ssIHVuSG9vaywgY29uZmlnRXZlbnQsIGV2ZW50c30gZnJvbSBcIi4veGhyLWhvb2tcIjtcblxudmFyIGV2ZW50TG9hZCA9IGV2ZW50c1swXSxcbiAgZXZlbnRMb2FkRW5kID0gZXZlbnRzWzFdLFxuICBldmVudFRpbWVvdXQgPSBldmVudHNbMl0sXG4gIGV2ZW50RXJyb3IgPSBldmVudHNbM10sXG4gIGV2ZW50UmVhZHlTdGF0ZUNoYW5nZSA9IGV2ZW50c1s0XSxcbiAgZXZlbnRBYm9ydCA9IGV2ZW50c1s1XTtcblxuXG52YXIgc2luZ2xldG9uLFxuICBwcm90b3R5cGUgPSAncHJvdG90eXBlJztcblxuXG5leHBvcnQgZnVuY3Rpb24gcHJveHkocHJveHkpIHtcbiAgaWYgKHNpbmdsZXRvbikgdGhyb3cgXCJQcm94eSBhbHJlYWR5IGV4aXN0c1wiO1xuICByZXR1cm4gc2luZ2xldG9uID0gbmV3IFByb3h5KHByb3h5KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuUHJveHkod2luKSB7XG4gIHNpbmdsZXRvbiA9IG51bGxcbiAgdW5Ib29rKHdpbilcbn1cblxuZnVuY3Rpb24gdHJpbShzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG59XG5cbmZ1bmN0aW9uIGdldEV2ZW50VGFyZ2V0KHhocikge1xuICByZXR1cm4geGhyLndhdGNoZXIgfHwgKHhoci53YXRjaGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpKTtcbn1cblxuZnVuY3Rpb24gdHJpZ2dlckxpc3RlbmVyKHhociwgbmFtZSkge1xuICB2YXIgeGhyUHJveHkgPSB4aHIuZ2V0UHJveHkoKTtcbiAgdmFyIGNhbGxiYWNrID0gJ29uJyArIG5hbWUgKyAnXyc7XG4gIHZhciBldmVudCA9IGNvbmZpZ0V2ZW50KHt0eXBlOiBuYW1lfSwgeGhyUHJveHkpO1xuICB4aHJQcm94eVtjYWxsYmFja10gJiYgeGhyUHJveHlbY2FsbGJhY2tdKGV2ZW50KTtcbiAgdmFyIGV2dDtcbiAgaWYgKHR5cGVvZihFdmVudCkgPT09ICdmdW5jdGlvbicpIHtcbiAgICBldnQgPSBuZXcgRXZlbnQobmFtZSwge2J1YmJsZXM6IGZhbHNlfSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjcxNzY5ODMvZGlzcGF0Y2hldmVudC1ub3Qtd29ya2luZy1pbi1pZTExXG4gICAgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG4gICAgZXZ0LmluaXRFdmVudChuYW1lLCBmYWxzZSwgdHJ1ZSk7XG4gIH1cbiAgZ2V0RXZlbnRUYXJnZXQoeGhyKS5kaXNwYXRjaEV2ZW50KGV2dCk7XG59XG5cblxuZnVuY3Rpb24gSGFuZGxlcih4aHIpIHtcbiAgdGhpcy54aHIgPSB4aHI7XG4gIHRoaXMueGhyUHJveHkgPSB4aHIuZ2V0UHJveHkoKTtcbn1cblxuSGFuZGxlcltwcm90b3R5cGVdID0gT2JqZWN0LmNyZWF0ZSh7XG4gIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUocmVzcG9uc2UpIHtcbiAgICB2YXIgeGhyUHJveHkgPSB0aGlzLnhoclByb3h5O1xuICAgIHZhciB4aHIgPSB0aGlzLnhocjtcbiAgICB4aHJQcm94eS5yZWFkeVN0YXRlID0gNDtcbiAgICB4aHIucmVzSGVhZGVyID0gcmVzcG9uc2UuaGVhZGVycztcbiAgICB4aHJQcm94eS5yZXNwb25zZSA9IHhoclByb3h5LnJlc3BvbnNlVGV4dCA9IHJlc3BvbnNlLnJlc3BvbnNlO1xuICAgIHhoclByb3h5LnN0YXR1c1RleHQgPSByZXNwb25zZS5zdGF0dXNUZXh0O1xuICAgIHhoclByb3h5LnN0YXR1cyA9IHJlc3BvbnNlLnN0YXR1cztcbiAgICB0cmlnZ2VyTGlzdGVuZXIoeGhyLCBldmVudFJlYWR5U3RhdGVDaGFuZ2UpO1xuICAgIHRyaWdnZXJMaXN0ZW5lcih4aHIsIGV2ZW50TG9hZCk7XG4gICAgdHJpZ2dlckxpc3RlbmVyKHhociwgZXZlbnRMb2FkRW5kKTtcbiAgfSxcbiAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoZXJyb3IpIHtcbiAgICB0aGlzLnhoclByb3h5LnN0YXR1cyA9IDA7XG4gICAgdHJpZ2dlckxpc3RlbmVyKHRoaXMueGhyLCBlcnJvci50eXBlKTtcbiAgICB0cmlnZ2VyTGlzdGVuZXIodGhpcy54aHIsIGV2ZW50TG9hZEVuZCk7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBtYWtlSGFuZGxlcihuZXh0KSB7XG4gIGZ1bmN0aW9uIHN1Yih4aHIpIHtcbiAgICBIYW5kbGVyLmNhbGwodGhpcywgeGhyKTtcbiAgfVxuXG4gIHN1Yltwcm90b3R5cGVdID0gT2JqZWN0LmNyZWF0ZShIYW5kbGVyW3Byb3RvdHlwZV0pO1xuICBzdWJbcHJvdG90eXBlXS5uZXh0ID0gbmV4dDtcbiAgcmV0dXJuIHN1Yjtcbn1cblxudmFyIFJlcXVlc3RIYW5kbGVyID0gbWFrZUhhbmRsZXIoZnVuY3Rpb24gKHJxKSB7XG4gIHZhciB4aHIgPSB0aGlzLnhocjtcbiAgcnEgPSBycSB8fCB4aHIuY29uZmlnO1xuICB4aHIud2l0aENyZWRlbnRpYWxzID0gcnEud2l0aENyZWRlbnRpYWxzO1xuICB4aHIub3BlbihycS5tZXRob2QsIHJxLnVybCwgcnEuYXN5bmMgIT09IGZhbHNlLCBycS51c2VyLCBycS5wYXNzd29yZCk7XG4gIGZvciAodmFyIGtleSBpbiBycS5oZWFkZXJzKSB7XG4gICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBycS5oZWFkZXJzW2tleV0pO1xuICB9XG4gIHhoci5zZW5kKHJxLmJvZHkpO1xufSk7XG5cbnZhciBSZXNwb25zZUhhbmRsZXIgPSBtYWtlSGFuZGxlcihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgdGhpcy5yZXNvbHZlKHJlc3BvbnNlKTtcbn0pO1xuXG52YXIgRXJyb3JIYW5kbGVyID0gbWFrZUhhbmRsZXIoZnVuY3Rpb24gKGVycm9yKSB7XG4gIHRoaXMucmVqZWN0KGVycm9yKTtcbn0pO1xuXG5mdW5jdGlvbiBQcm94eShwcm94eSwgd2luKSB7XG4gIHZhciBvblJlcXVlc3QgPSBwcm94eS5vblJlcXVlc3QsXG4gICAgb25SZXNwb25zZSA9IHByb3h5Lm9uUmVzcG9uc2UsXG4gICAgb25FcnJvciA9IHByb3h5Lm9uRXJyb3I7XG5cbiAgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UoeGhyLCB4aHJQcm94eSkge1xuICAgIHZhciBoYW5kbGVyID0gbmV3IFJlc3BvbnNlSGFuZGxlcih4aHIpO1xuICAgIHZhciByZXQgPSB7XG4gICAgICByZXNwb25zZTogeGhyUHJveHkucmVzcG9uc2UsXG4gICAgICBzdGF0dXM6IHhoclByb3h5LnN0YXR1cyxcbiAgICAgIHN0YXR1c1RleHQ6IHhoclByb3h5LnN0YXR1c1RleHQsXG4gICAgICBjb25maWc6IHhoci5jb25maWcsXG4gICAgICBoZWFkZXJzOiB4aHIucmVzSGVhZGVyIHx8IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKS5zcGxpdCgnXFxyXFxuJykucmVkdWNlKGZ1bmN0aW9uIChvYiwgc3RyKSB7XG4gICAgICAgIGlmIChzdHIgPT09IFwiXCIpIHJldHVybiBvYjtcbiAgICAgICAgdmFyIG0gPSBzdHIuc3BsaXQoXCI6XCIpO1xuICAgICAgICBvYlttLnNoaWZ0KCldID0gdHJpbShtLmpvaW4oJzonKSk7XG4gICAgICAgIHJldHVybiBvYjtcbiAgICAgIH0sIHt9KVxuICAgIH07XG4gICAgaWYgKCFvblJlc3BvbnNlKSByZXR1cm4gaGFuZGxlci5yZXNvbHZlKHJldCk7XG4gICAgb25SZXNwb25zZShyZXQsIGhhbmRsZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25lcnJvcih4aHIsIHhoclByb3h5LCBlcnJvciwgZXJyb3JUeXBlKSB7XG4gICAgdmFyIGhhbmRsZXIgPSBuZXcgRXJyb3JIYW5kbGVyKHhocik7XG4gICAgZXJyb3IgPSB7Y29uZmlnOiB4aHIuY29uZmlnLCBlcnJvcjogZXJyb3IsIHR5cGU6IGVycm9yVHlwZX07XG4gICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgIG9uRXJyb3IoZXJyb3IsIGhhbmRsZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBoYW5kbGVyLm5leHQoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHByZXZlbnRYaHJQcm94eUNhbGxiYWNrKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhlcnJvclR5cGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhociwgZSkge1xuICAgICAgb25lcnJvcih4aHIsIHRoaXMsIGUsIGVycm9yVHlwZSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzdGF0ZUNoYW5nZUNhbGxiYWNrKHhociwgeGhyUHJveHkpIHtcbiAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQgJiYgeGhyLnN0YXR1cyAhPT0gMCkge1xuICAgICAgaGFuZGxlUmVzcG9uc2UoeGhyLCB4aHJQcm94eSk7XG4gICAgfSBlbHNlIGlmICh4aHIucmVhZHlTdGF0ZSAhPT0gNCkge1xuICAgICAgdHJpZ2dlckxpc3RlbmVyKHhociwgZXZlbnRSZWFkeVN0YXRlQ2hhbmdlKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gaG9vayh7XG4gICAgb25sb2FkOiBwcmV2ZW50WGhyUHJveHlDYWxsYmFjayxcbiAgICBvbmxvYWRlbmQ6IHByZXZlbnRYaHJQcm94eUNhbGxiYWNrLFxuICAgIG9uZXJyb3I6IGVycm9yQ2FsbGJhY2soZXZlbnRFcnJvciksXG4gICAgb250aW1lb3V0OiBlcnJvckNhbGxiYWNrKGV2ZW50VGltZW91dCksXG4gICAgb25hYm9ydDogZXJyb3JDYWxsYmFjayhldmVudEFib3J0KSxcbiAgICBvbnJlYWR5c3RhdGVjaGFuZ2U6IGZ1bmN0aW9uICh4aHIpIHtcbiAgICAgIHJldHVybiBzdGF0ZUNoYW5nZUNhbGxiYWNrKHhociwgdGhpcyk7XG4gICAgfSxcbiAgICBvcGVuOiBmdW5jdGlvbiBvcGVuKGFyZ3MsIHhocikge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIHZhciBjb25maWcgPSB4aHIuY29uZmlnID0ge2hlYWRlcnM6IHt9fTtcbiAgICAgIGNvbmZpZy5tZXRob2QgPSBhcmdzWzBdO1xuICAgICAgY29uZmlnLnVybCA9IGFyZ3NbMV07XG4gICAgICBjb25maWcuYXN5bmMgPSBhcmdzWzJdO1xuICAgICAgY29uZmlnLnVzZXIgPSBhcmdzWzNdO1xuICAgICAgY29uZmlnLnBhc3N3b3JkID0gYXJnc1s0XTtcbiAgICAgIGNvbmZpZy54aHIgPSB4aHI7XG4gICAgICB2YXIgZXZOYW1lID0gJ29uJyArIGV2ZW50UmVhZHlTdGF0ZUNoYW5nZTtcbiAgICAgIGlmICgheGhyW2V2TmFtZV0pIHtcbiAgICAgICAgeGhyW2V2TmFtZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlQ2hhbmdlQ2FsbGJhY2soeGhyLCBfdGhpcyk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIOWmguaenOacieivt+axguaLpuaIquWZqO+8jOWImeWcqOiwg+eUqG9uUmVxdWVzdOWQjuWGjeaJk+W8gOmTvuaOpeOAguWboOS4um9uUmVxdWVzdOacgOS9s+iwg+eUqOaXtuacuuaYr+WcqHNlbmTliY3vvIxcbiAgICAgIC8vIOaJgOS7peaIkeS7rOWcqHNlbmTmi6bmiKrlh73mlbDkuK3lho3miYvliqjosIPnlKhvcGVu77yM5Zug5q2k6L+U5ZuedHJ1ZemYu+atonhoci5vcGVu6LCD55So44CCXG4gICAgICAvL1xuICAgICAgLy8g5aaC5p6c5rKh5pyJ6K+35rGC5oum5oiq5Zmo77yM5YiZ5LiN55So6Zi75pateGhyLm9wZW7osIPnlKhcbiAgICAgIGlmIChvblJlcXVlc3QpIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgc2VuZDogZnVuY3Rpb24gKGFyZ3MsIHhocikge1xuICAgICAgdmFyIGNvbmZpZyA9IHhoci5jb25maWdcbiAgICAgIGNvbmZpZy53aXRoQ3JlZGVudGlhbHMgPSB4aHIud2l0aENyZWRlbnRpYWxzXG4gICAgICBjb25maWcuYm9keSA9IGFyZ3NbMF07XG4gICAgICBpZiAob25SZXF1ZXN0KSB7XG4gICAgICAgIC8vIEluICdvblJlcXVlc3QnLCB3ZSBtYXkgY2FsbCBYSFIncyBldmVudCBoYW5kbGVyLCBzdWNoIGFzIGB4aHIub25sb2FkYC5cbiAgICAgICAgLy8gSG93ZXZlciwgWEhSJ3MgZXZlbnQgaGFuZGxlciBtYXkgbm90IGJlIHNldCB1bnRpbCB4aHIuc2VuZCBpcyBjYWxsZWQgaW5cbiAgICAgICAgLy8gdGhlIHVzZXIncyBjb2RlLCBzbyB3ZSB1c2UgYHNldFRpbWVvdXRgIHRvIGF2b2lkIHRoaXMgc2l0dWF0aW9uXG4gICAgICAgIHZhciByZXEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgb25SZXF1ZXN0KGNvbmZpZywgbmV3IFJlcXVlc3RIYW5kbGVyKHhocikpO1xuICAgICAgICB9XG4gICAgICAgIGNvbmZpZy5hc3luYyA9PT0gZmFsc2UgPyByZXEoKSA6IHNldFRpbWVvdXQocmVxKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uIChhcmdzLCB4aHIpIHtcbiAgICAgIC8vIENvbGxlY3QgcmVxdWVzdCBoZWFkZXJzXG4gICAgICB4aHIuY29uZmlnLmhlYWRlcnNbYXJnc1swXS50b0xvd2VyQ2FzZSgpXSA9IGFyZ3NbMV07XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uIChhcmdzLCB4aHIpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICBpZiAoZXZlbnRzLmluZGV4T2YoYXJnc1swXSkgIT09IC0xKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gYXJnc1sxXTtcbiAgICAgICAgZ2V0RXZlbnRUYXJnZXQoeGhyKS5hZGRFdmVudExpc3RlbmVyKGFyZ3NbMF0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyIGV2ZW50ID0gY29uZmlnRXZlbnQoZSwgX3RoaXMpO1xuICAgICAgICAgIGV2ZW50LnR5cGUgPSBhcmdzWzBdO1xuICAgICAgICAgIGV2ZW50LmlzVHJ1c3RlZCA9IHRydWU7XG4gICAgICAgICAgaGFuZGxlci5jYWxsKF90aGlzLCBldmVudCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24gKF8sIHhocikge1xuICAgICAgdmFyIGhlYWRlcnMgPSB4aHIucmVzSGVhZGVyXG4gICAgICBpZiAoaGVhZGVycykge1xuICAgICAgICB2YXIgaGVhZGVyID0gXCJcIjtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGhlYWRlcnMpIHtcbiAgICAgICAgICBoZWFkZXIgKz0ga2V5ICsgJzogJyArIGhlYWRlcnNba2V5XSArICdcXHJcXG4nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZWFkZXI7XG4gICAgICB9XG4gICAgfSxcbiAgICBnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24gKGFyZ3MsIHhocikge1xuICAgICAgdmFyIGhlYWRlcnMgPSB4aHIucmVzSGVhZGVyXG4gICAgICBpZiAoaGVhZGVycykge1xuICAgICAgICByZXR1cm4gaGVhZGVyc1soYXJnc1swXSB8fCAnJykudG9Mb3dlckNhc2UoKV07XG4gICAgICB9XG4gICAgfVxuICB9LCB3aW4pO1xufVxuXG5cblxuXG4iLCJsZXQgY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCA9IG51bGxcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAvLyDliJvlu7rlrrnlmahcbiAgICBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSAnY2hyb21lLW5vdGlmaWNhdGlvbidcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcilcbn1cblxudHlwZSBvcGVuUHJvcHMgPSB7XG4gICAgdGl0bGU6IHN0cmluZyxcbiAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgdGltZW91dD86IG51bWJlclxufVxuXG5leHBvcnQgZnVuY3Rpb24gb3Blbih7XG4gICAgdGl0bGUsXG4gICAgY29udGVudCxcbiAgICB0aW1lb3V0ID0gMzAwMFxufTogb3BlblByb3BzKSB7XG4gICAgLy8g5Yib5bu66IqC54K5XG4gICAgY29uc3QgcGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHBhbmVsLmNsYXNzTmFtZSA9ICdjaHJvbWUtbm90aWZpY2F0aW9uLXBhbmVsJ1xuXG4gICAgLy8g5Yib5bu6dGl0bGVcbiAgICBjb25zdCB0aXRsZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0aXRsZUVsLmNsYXNzTmFtZSA9ICdjaHJvbWUtbm90aWZpY2F0aW9uLXBhbmVsLXRpdGxlJ1xuXG4gICAgLy8g5Yib5bu6dGl0bGXmloflrZdcbiAgICBjb25zdCB0aXRsZVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICB0aXRsZVRleHQuaW5uZXJUZXh0ID0gdGl0bGVcblxuICAgIC8vIOWIm+W7uuWFs+mXreaMiemSrlxuICAgIGNvbnN0IHRpdGxlQ2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJylcbiAgICB0aXRsZUNsb3NlQnRuLmNsYXNzTmFtZSA9ICdjaHJvbWUtbm90aWZpY2F0aW9uLXBhbmVsLXRpdGxlLWNsb3NlJ1xuICAgIHRpdGxlQ2xvc2VCdG4uaW5uZXJUZXh0ID0gJ3gnXG4gICAgZnVuY3Rpb24gY2xvc2VOKCkge1xuICAgICAgICB0aXRsZUNsb3NlQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VOKVxuICAgICAgICBjb25zdCB3aWR0aCA9IHBhbmVsLmNsaWVudFdpZHRoXG5cbiAgICAgICAgbGV0IHRhcmdldCA9IDBcblxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gY2xvc2VBbmltKCkge1xuICAgICAgICAgICAgdGFyZ2V0ICs9IHdpZHRoIC8gMTdcbiAgICAgICAgICAgIHBhbmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7dGFyZ2V0fXB4KWBcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPCB3aWR0aCArIDE2KSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNsb3NlQW5pbSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFuZWwucmVtb3ZlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG4gICAgdGl0bGVDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTilcblxuICAgIC8vIOWIm+W7umNvbnRlbnRcbiAgICBjb25zdCBjb250ZW50RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbnRlbnRFbC5jbGFzc05hbWUgPSAnY2hyb21lLW5vdGlmaWNhdGlvbi1wYW5lbC1jb250ZW50J1xuICAgIGNvbnRlbnRFbC5pbm5lckhUTUwgPSBjb250ZW50XG5cbiAgICB0aXRsZUVsLmFwcGVuZENoaWxkKHRpdGxlVGV4dClcbiAgICB0aXRsZUVsLmFwcGVuZENoaWxkKHRpdGxlQ2xvc2VCdG4pXG5cbiAgICBwYW5lbC5hcHBlbmRDaGlsZCh0aXRsZUVsKVxuICAgIHBhbmVsLmFwcGVuZENoaWxkKGNvbnRlbnRFbClcblxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwYW5lbClcblxuXG4gICAgY29uc3Qgd2lkdGggPSBwYW5lbC5jbGllbnRXaWR0aFxuICAgIHBhbmVsLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7d2lkdGggKyAxNn1weClgXG4gICAgbGV0IHRhcmdldCA9IHdpZHRoICsgMTZcblxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiBvcGVuQW5pbSgpIHtcbiAgICAgICAgdGFyZ2V0IC09IHdpZHRoIC8gMTdcbiAgICAgICAgcGFuZWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHt0YXJnZXR9cHgpYFxuICAgICAgICBpZiAodGFyZ2V0ID4gMCkge1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKG9wZW5BbmltKVxuICAgICAgICB9XG4gICAgfSlcblxuICAgIHNldFRpbWVvdXQoY2xvc2VOLCB0aW1lb3V0KTtcbn1cblxuaW5pdCgpIiwiLy8gQHRzLW5vY2hlY2tcbmltcG9ydCB7IHByb3h5LCB1blByb3h5IH0gZnJvbSBcImFqYXgtaG9va1wiO1xuaW1wb3J0IHsgb3BlbiB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvbm90aWZpY2F0aW9uJ1xuXG5sZXQgbWF0Y2hpbmdzOiBNYXRjaGluZ0VudGl0eVtdID0gW11cblxucHJveHkoe1xuICAgIC8v6K+35rGC5Y+R6LW35YmN6L+b5YWlXG4gICAgb25SZXF1ZXN0OiBhc3luYyAoY29uZmlnLCBoYW5kbGVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHNob3dOID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Nocm9tZV9tb2NrX2V4dF9zaG93X25vdGlmaWNhdGlvbicpID09PSAnMSdcbiAgICAgICAgZm9yIChjb25zdCBtYXRjaGluZyBvZiBtYXRjaGluZ3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4cCA9IG5ldyBSZWdFeHAobWF0Y2hpbmcucmVnZXhwU3RyKVxuICAgICAgICAgICAgaWYgKHJlZ2V4cC50ZXN0KGNvbmZpZy51cmwpKSB7XG4gICAgICAgICAgICAgICAgb3Blbih7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAneGhyX21vY2tfZXh05oum5oiq5o+Q6YaSJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYC88c3BhbiBzdHlsZT1cImNvbG9yOnJlZFwiPiR7bWF0Y2hpbmcucmVnZXhwU3RyfTwvc3Bhbj4vICzlt7Looqvmi6bmiKpgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1hdGNoaW5nSGFuZGxlcihtYXRjaGluZywgY29uZmlnKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKVxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVyLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgnIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBoYW5kbGVyLm5leHQoY29uZmlnKTtcbiAgICB9XG59KVxuXG5hc3luYyBmdW5jdGlvbiBtYXRjaGluZ0hhbmRsZXIobWF0Y2hpbmc6IE1hdGNoaW5nRW50aXR5LCBjb25maWcpOiBzdHJpbmcge1xuICAgIGNvbnNvbGUubG9nKG1hdGNoaW5nKVxuICAgIHN3aXRjaCAobWF0Y2hpbmcubW9kZSkge1xuICAgICAgICBjYXNlIDA6IHJldHVybiBtYXRjaGluZy5yZXNKc29uO1xuICAgICAgICBjYXNlIDE6IHJldHVybiBhd2FpdCBzY3JpcHRIYW5kbGVyKG1hdGNoaW5nLCBjb25maWcpXG4gICAgfVxufVxuXG5cbmFzeW5jIGZ1bmN0aW9uIHNjcmlwdEhhbmRsZXIobWF0Y2hpbmc6IE1hdGNoaW5nRW50aXR5LCBjb25maWcpIHtcbiAgICBjb25zdCBtaWRkbGV3YXJlID0gbmV3IEZ1bmN0aW9uKG1hdGNoaW5nLnJlc1NjcmlwdClcblxuICAgIHJldHVybiBhd2FpdCBtaWRkbGV3YXJlKGNvbmZpZylcbn1cblxuXG5mdW5jdGlvbiBpbml0KCkge1xuICAgIGdldE1hdGNoaW5ncygpXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gZVxuXG4gICAgICAgIGlmIChkYXRhLmV2ZW50ID09PSAnaW5qZWN0X2dldF9tYXRjaGluZ19yZXMnKSB7XG4gICAgICAgICAgICBtYXRjaGluZ3MgPSBlLmRhdGEuZGF0YVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gZ2V0TWF0Y2hpbmdzKCkge1xuICAgIHdpbmRvdy5wb3N0TWVzc2FnZSh7XG4gICAgICAgIGV2ZW50OiAnaW5qZWN0X2dldF9tYXRjaGluZycsXG4gICAgICAgIGRhdGE6IG51bGxcbiAgICB9KVxufVxuXG5pbml0KCkiXSwibmFtZXMiOlsiZXZlbnRzIiwiY29uZmlnRXZlbnQiLCJldmVudCIsInhoclByb3h5IiwiZSIsImF0dHIiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0Iiwic2luZ2xldG9uIiwiZXZlbnRMb2FkIiwiZXZlbnRMb2FkRW5kIiwiZXZlbnRUaW1lb3V0IiwiZXZlbnRFcnJvciIsImV2ZW50UmVhZHlTdGF0ZUNoYW5nZSIsImV2ZW50QWJvcnQiLCJnZXRFdmVudFRhcmdldCIsInhociIsIndhdGNoZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0cmlnZ2VyTGlzdGVuZXIiLCJuYW1lIiwiZXZ0IiwiZ2V0UHJveHkiLCJjYWxsYmFjayIsInR5cGUiLCJFdmVudCIsImJ1YmJsZXMiLCJjcmVhdGVFdmVudCIsImluaXRFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJIYW5kbGVyIiwidGhpcyIsIm1ha2VIYW5kbGVyIiwibmV4dCIsInN1YiIsImNhbGwiLCJPYmplY3QiLCJjcmVhdGUiLCJyZXNvbHZlIiwicmVzcG9uc2UiLCJyZWFkeVN0YXRlIiwicmVzSGVhZGVyIiwiaGVhZGVycyIsInJlc3BvbnNlVGV4dCIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJyZWplY3QiLCJlcnJvciIsIlJlcXVlc3RIYW5kbGVyIiwicnEiLCJrZXkiLCJjb25maWciLCJ3aXRoQ3JlZGVudGlhbHMiLCJvcGVuIiwibWV0aG9kIiwidXJsIiwiYXN5bmMiLCJ1c2VyIiwicGFzc3dvcmQiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsImJvZHkiLCJSZXNwb25zZUhhbmRsZXIiLCJFcnJvckhhbmRsZXIiLCJQcm94eSIsInByb3h5Iiwid2luIiwib25SZXF1ZXN0Iiwib25SZXNwb25zZSIsIm9uRXJyb3IiLCJwcmV2ZW50WGhyUHJveHlDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJlcnJvclR5cGUiLCJoYW5kbGVyIiwib25lcnJvciIsInN0YXRlQ2hhbmdlQ2FsbGJhY2siLCJyZXQiLCJnZXRBbGxSZXNwb25zZUhlYWRlcnMiLCJzcGxpdCIsInJlZHVjZSIsIm9iIiwic3RyIiwibSIsInNoaWZ0IiwicmVwbGFjZSIsInRyaW0iLCJqb2luIiwiaGFuZGxlUmVzcG9uc2UiLCJnZXR0ZXJGYWN0b3J5IiwidiIsImhhc093blByb3BlcnR5IiwiYXR0ckdldHRlckhvb2siLCJzZXR0ZXJGYWN0b3J5IiwidGhhdCIsImhvb2siLCJzdWJzdHJpbmciLCJhdHRyU2V0dGVySG9vayIsImhvb2tGdW5jdGlvbiIsImZ1biIsImFyZ3MiLCJzbGljZSIsImFyZ3VtZW50cyIsImFwcGx5Iiwid2luZG93IiwiWE1MSHR0cFJlcXVlc3QiLCJpIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiZGVmaW5lUHJvcGVydHkiLCJnZXQiLCJzZXQiLCJlbnVtZXJhYmxlIiwiYXNzaWduIiwiVU5TRU5UIiwiT1BFTkVEIiwiSEVBREVSU19SRUNFSVZFRCIsIkxPQURJTkciLCJET05FIiwib25sb2FkIiwib25sb2FkZW5kIiwib250aW1lb3V0Iiwib25hYm9ydCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsIl90aGlzIiwiZXZOYW1lIiwicmVxIiwic2V0VGltZW91dCIsInRvTG93ZXJDYXNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImluZGV4T2YiLCJpc1RydXN0ZWQiLCJfIiwiaGVhZGVyIiwiZ2V0UmVzcG9uc2VIZWFkZXIiLCJjb250YWluZXIiLCJjbGFzc05hbWUiLCJhcHBlbmRDaGlsZCIsIm1hdGNoaW5ncyIsIm1hdGNoaW5nSGFuZGxlciIsIm1hdGNoaW5nIiwiY29uc29sZSIsImxvZyIsIm1vZGUiLCJyZXNKc29uIiwic2NyaXB0SGFuZGxlciIsIkZ1bmN0aW9uIiwicmVzU2NyaXB0IiwibWlkZGxld2FyZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJSZWdFeHAiLCJyZWdleHBTdHIiLCJ0ZXN0IiwidGl0bGUiLCJjb250ZW50IiwidGltZW91dCIsInBhbmVsIiwidGl0bGVFbCIsInRpdGxlVGV4dCIsImlubmVyVGV4dCIsInRpdGxlQ2xvc2VCdG4iLCJjbG9zZU4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2lkdGgiLCJjbGllbnRXaWR0aCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNsb3NlQW5pbSIsInN0eWxlIiwidHJhbnNmb3JtIiwicmVtb3ZlIiwiY29udGVudEVsIiwiaW5uZXJIVE1MIiwib3BlbkFuaW0iLCJwb3N0TWVzc2FnZSIsImRhdGEiXSwic291cmNlUm9vdCI6IiJ9